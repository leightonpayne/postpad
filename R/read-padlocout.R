#' Read PADLOC output files
#' @param path The path to a PADLOC output file (i.e. the files generated by
#' PADLOC ending in '*_padloc.csv').
#' @return A [tibble::tibble()] holding the contents of the PADLOC output file.
#' @export
read_padlocout <- function(path) {

  cols <- readr::cols(
    system.number      = readr::col_character(),
    seqid              = readr::col_character(),
    system             = readr::col_character(),
    target.name        = readr::col_character(),
    hmm.accession      = readr::col_character(),
    hmm.name           = readr::col_character(),
    protein.name       = readr::col_character(),
    full.seq.E.value   = readr::col_character(),
    domain.iE.value    = readr::col_character(),
    target.coverage    = readr::col_character(),
    hmm.coverage       = readr::col_character(),
    start              = readr::col_character(),
    end                = readr::col_character(),
    strand             = readr::col_character(),
    target.description = readr::col_character(),
    relative.position  = readr::col_character(),
    contig.end         = readr::col_character(),
    all.domains        = readr::col_character(),
    best.hits          = readr::col_character()
  )

  out <- readr::read_csv(path, col_names = names(cols), col_types = cols)
  out

}

#' Read multiple PADLOC output files
#' @param path The path to a directory containing PADLOC output files (i.e.
#' the files generated by PADLOC ending in '*_padloc.csv').
#' @return A [list()], where each element is a [tibble::tibble()] holding
#' the contents of a PADLOC output file, as read by [read_padlocout()].
#' @export
multi_read_padlocout <- function(path) {
  file_paths <- list.files(path, full.names = TRUE, pattern = "*_padloc.csv")
  file_content <- purrr::map(.x = file_paths, .f = function(x) read_padlocout(x))
  file_names <- stringr::str_remove(basename(file_paths), "_protein_padloc.csv")
  names(file_content) <- file_names
  file_content
}
